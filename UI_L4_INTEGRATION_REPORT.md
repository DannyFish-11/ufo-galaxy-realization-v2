# UFO Galaxy UIä¸L4ä¸»å¾ªç¯é›†æˆæŠ¥å‘Š

## æ¦‚è¿°

æœ¬æŠ¥å‘Šè¯¦ç»†æè¿°äº†UFO Galaxyç³»ç»Ÿçš„UIä¸L4ä¸»å¾ªç¯çš„å®Œæ•´é›†æˆå®ç°ã€‚é€šè¿‡4ä¸ªå…³é”®é›†æˆç‚¹çš„å®ç°ï¼Œæ‰“é€šäº†ç”¨æˆ·è¾“å…¥åˆ°ç³»ç»Ÿæ‰§è¡Œçš„å®Œæ•´é“¾è·¯ã€‚

---

## é›†æˆæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           UFO Galaxy é›†æˆæ¶æ„                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Windowså®¢æˆ·ç«¯   â”‚     â”‚   Androidå®¢æˆ·ç«¯   â”‚     â”‚   ç¡¬ä»¶è§¦å‘å™¨      â”‚
â”‚  (PyQt6 UI)      â”‚     â”‚  (Kotlin/Compose)â”‚     â”‚  (æŒ‰é”®/æ‰‹åŠ¿)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                        â”‚                        â”‚
         â”‚  1. UI â†’ L4            â”‚  1. UI â†’ L4            â”‚  3. ç¡¬ä»¶ â†’ UI
         â”‚  (å‘½ä»¤æäº¤)             â”‚  (WebSocket/HTTP)      â”‚  (å”¤é†’/æ‰‹åŠ¿)
         â”‚                        â”‚                        â”‚
         â–¼                        â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           äº‹ä»¶æ€»çº¿ (EventBus)                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  EventType:                                                         â”‚   â”‚
â”‚  â”‚  - GOAL_SUBMITTED, GOAL_DECOMPOSITION_*                             â”‚   â”‚
â”‚  â”‚  - PLAN_GENERATION_*, ACTION_EXECUTION_*                            â”‚   â”‚
â”‚  â”‚  - TASK_COMPLETED, ERROR_OCCURRED                                   â”‚   â”‚
â”‚  â”‚  - HARDWARE_TRIGGER_DETECTED, STATE_TRANSITION                      â”‚   â”‚
â”‚  â”‚  - ANIMATION_STARTED, ANIMATION_COMPLETED                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                        â”‚                        â–²
         â”‚                        â”‚                        â”‚
         â”‚  2. L4 â†’ UI            â”‚                        â”‚  4. UI â†’ ç¡¬ä»¶
         â”‚  (è¿›åº¦å›è°ƒ)             â”‚                        â”‚  (åŠ¨ç”»å®Œæˆé€šçŸ¥)
         â–¼                        â”‚                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      L4ä¸»å¾ªç¯ (GalaxyMainLoopL4Enhanced)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æ ¸å¿ƒåŠŸèƒ½:                                                           â”‚   â”‚
â”‚  â”‚  - receive_goal(): æ¥æ”¶å¤–éƒ¨ç›®æ ‡                                      â”‚   â”‚
â”‚  â”‚  - run_cycle(): æ‰§è¡Œå®Œæ•´L4å‘¨æœŸ                                       â”‚   â”‚
â”‚  â”‚  - _decompose_goal(): ç›®æ ‡åˆ†è§£                                       â”‚   â”‚
â”‚  â”‚  - _create_plan(): è®¡åˆ’ç”Ÿæˆ                                          â”‚   â”‚
â”‚  â”‚  - _execute_plan(): è®¡åˆ’æ‰§è¡Œ                                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç³»ç»ŸçŠ¶æ€æœº (SystemStateMachine)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  çŠ¶æ€: SLEEPING â†’ ISLAND â†’ SIDESHEET â†’ FULLSCREEN                   â”‚   â”‚
â”‚  â”‚  è§¦å‘: wakeup(), expand_to_sidesheet(), expand_to_fullscreen()      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4ä¸ªé›†æˆç‚¹è¯¦ç»†å®ç°

### 1. UI â†’ L4ï¼ˆç”¨æˆ·è¾“å…¥åˆ°ç³»ç»Ÿæ‰§è¡Œï¼‰

#### Windowså®¢æˆ·ç«¯å®ç°
**æ–‡ä»¶**: `windows_client/windows_client_integrated.py`

```python
def _on_command_submitted(self):
    """å‘½ä»¤æäº¤å›è°ƒï¼ˆUI â†’ L4 é›†æˆç‚¹ï¼‰"""
    command = self.input_field.text().strip()
    
    # 1. è§£æç”¨æˆ·æ„å›¾
    intent = self._parse_user_intent(command)
    
    # 2. æäº¤åˆ°L4ä¸»å¾ªç¯
    goal_id = self.l4_thread.submit_goal(command)
    
    # 3. åˆ›å»ºUIä»»åŠ¡å¹¶æ›´æ–°åˆ—è¡¨
    task = UITask(task_id=goal_id, description=command, status=TaskStatus.PENDING)
    self.tasks[goal_id] = task
    self._update_tasks_list()
```

**å…³é”®ä»£ç è¡Œæ•°**: çº¦150è¡Œ

#### Androidå®¢æˆ·ç«¯å®ç°
**æ–‡ä»¶**: `android_client/MainActivityIntegrated.kt`

```kotlin
fun onCommandSubmitted(command: String) {
    // 1. è§£æç”¨æˆ·æ„å›¾
    val intent = parseUserIntent(command)
    
    // 2. é€šè¿‡WebSocketå‘é€
    val message = JSONObject().apply {
        put("type", "goal_submit")
        put("description", command)
        put("intent", JSONObject().apply {
            put("type", intent.intentType)
            put("confidence", intent.confidence)
        })
    }
    webSocketManager.send(message.toString())
}
```

**å…³é”®ä»£ç è¡Œæ•°**: çº¦200è¡Œ

#### L4ä¸»å¾ªç¯æ¥æ”¶ç«¯
**æ–‡ä»¶**: `core/galaxy_main_loop_l4_enhanced.py`

```python
def receive_goal(self, goal_description: str, goal_type: Any = None, 
                 constraints: List[str] = None, 
                 success_criteria: List[str] = None,
                 priority: int = 0) -> str:
    """æ¥æ”¶å¤–éƒ¨ç›®æ ‡ï¼ˆUI â†’ L4 å…¥å£ï¼‰"""
    goal_id = str(uuid.uuid4())
    
    pending_goal = PendingGoal(
        goal_id=goal_id,
        description=goal_description,
        goal_type=goal_type,
        constraints=constraints or [],
        success_criteria=success_criteria or [],
        deadline=None,
        priority=priority
    )
    
    # æ·»åŠ åˆ°é˜Ÿåˆ—
    asyncio.create_task(self._goal_queue.put(pending_goal))
    
    # å‘å¸ƒäº‹ä»¶
    event_bus.publish_sync(
        EventType.GOAL_SUBMITTED,
        "ui",
        {"goal_id": goal_id, "description": goal_description}
    )
    
    return goal_id
```

**å…³é”®ä»£ç è¡Œæ•°**: çº¦80è¡Œ

---

### 2. L4 â†’ UIï¼ˆç³»ç»Ÿæ‰§è¡Œåˆ°ç•Œé¢æ›´æ–°ï¼‰

#### äº‹ä»¶æ€»çº¿å®ç°
**æ–‡ä»¶**: `integration/event_bus.py`

```python
class UIProgressCallback:
    """UIè¿›åº¦å›è°ƒç±» - ç”¨äºL4ä¸»å¾ªç¯å‘UIæŠ¥å‘Šè¿›åº¦"""
    
    def on_goal_decomposition_started(self, goal_description: str):
        event_bus.publish_sync(
            EventType.GOAL_DECOMPOSITION_STARTED,
            "l4",
            {"goal_description": goal_description}
        )
    
    def on_goal_decomposition_completed(self, goal_description: str, subtasks: List[Dict]):
        event_bus.publish_sync(
            EventType.GOAL_DECOMPOSITION_COMPLETED,
            "l4",
            {"goal_description": goal_description, "subtasks": subtasks}
        )
    
    def on_action_execution_progress(self, action_id: str, progress: float, message: str = ""):
        event_bus.publish_sync(
            EventType.ACTION_EXECUTION_PROGRESS,
            "l4",
            {"action_id": action_id, "progress": progress, "message": message}
        )
```

**å…³é”®ä»£ç è¡Œæ•°**: çº¦120è¡Œ

#### L4ä¸»å¾ªç¯ä¸­çš„è¿›åº¦å›è°ƒ
**æ–‡ä»¶**: `core/galaxy_main_loop_l4_enhanced.py`

```python
async def run_cycle(self) -> L4CycleResult:
    # 2. åˆ†è§£ï¼šå°†ç›®æ ‡åˆ†è§£ä¸ºå­ä»»åŠ¡
    self._progress_callback.on_goal_decomposition_started(goal.description)
    subtasks = await self._decompose_goal(goal)
    self._progress_callback.on_goal_decomposition_completed(...)
    
    # 3. è§„åˆ’ï¼šåˆ›å»ºæ‰§è¡Œè®¡åˆ’
    self._progress_callback.on_plan_generation_started(goal.description)
    plan = await self._create_plan(goal, subtasks)
    self._progress_callback.on_plan_generation_completed(...)
    
    # 4. æ‰§è¡Œï¼šæ‰§è¡Œè®¡åˆ’
    for action in actions:
        self._progress_callback.on_action_execution_started(action_id, action_command)
        # ... æ‰§è¡Œä¸­æ›´æ–°è¿›åº¦
        self._progress_callback.on_action_execution_progress(action_id, progress, message)
        self._progress_callback.on_action_execution_completed(action_id, success, result)
```

**å…³é”®ä»£ç è¡Œæ•°**: çº¦100è¡Œ

#### Androidå®¢æˆ·ç«¯æ¥æ”¶ç«¯
**æ–‡ä»¶**: `android_client/MainActivityIntegrated.kt`

```kotlin
private fun handleServerMessage(message: String) {
    val json = JSONObject(message)
    val eventType = json.optString("event_type")
    
    when (eventType) {
        "GOAL_DECOMPOSITION_COMPLETED" -> {
            val count = data?.optInt("subtask_count", 0) ?: 0
            updateStatus("ç›®æ ‡åˆ†è§£å®Œæˆ: $count ä¸ªå­ä»»åŠ¡")
            addMessage(Message(...))
        }
        "ACTION_EXECUTION_PROGRESS" -> {
            val progress = data?.optDouble("progress", 0.0) ?: 0.0
            updateProgress(progress.toFloat())
        }
        "TASK_COMPLETED" -> {
            val success = data?.optBoolean("success", false) ?: false
            updateStatus("ä»»åŠ¡å®Œæˆ: ${if (success) "æˆåŠŸ" else "å¤±è´¥"}")
        }
    }
}
```

**å…³é”®ä»£ç è¡Œæ•°**: çº¦150è¡Œ

---

### 3. ç¡¬ä»¶è§¦å‘ â†’ UIï¼ˆç¡¬ä»¶äº‹ä»¶åˆ°ç•Œé¢å“åº”ï¼‰

#### çŠ¶æ€æœºå®ç°
**æ–‡ä»¶**: `system_integration/state_machine_ui_integration.py`

```python
class SystemStateMachine:
    def wakeup(self, trigger_type: TriggerType = TriggerType.HARDWARE_BUTTON,
               trigger_source: str = "hardware") -> bool:
        """å”¤é†’ç³»ç»Ÿï¼ˆç¡¬ä»¶è§¦å‘ â†’ UI é›†æˆç‚¹ï¼‰"""
        # å‘å¸ƒç¡¬ä»¶è§¦å‘äº‹ä»¶
        event_bus.publish_sync(
            EventType.HARDWARE_TRIGGER_DETECTED,
            trigger_source,
            {"trigger_type": trigger_type.value, "action": "wakeup"}
        )
        
        # è½¬æ¢åˆ°çµåŠ¨å²›çŠ¶æ€
        success = self.transition_to(SystemState.ISLAND, trigger_type, trigger_source)
        return success
```

**å…³é”®ä»£ç è¡Œæ•°**: çº¦80è¡Œ

#### ç¡¬ä»¶è§¦å‘ç®¡ç†å™¨
**æ–‡ä»¶**: `system_integration/state_machine_ui_integration.py`

```python
class HardwareTriggerManager:
    def __init__(self):
        # æ³¨å†ŒUIå›è°ƒï¼ˆç¡¬ä»¶è§¦å‘ â†’ UI é›†æˆç‚¹ï¼‰
        self.state_machine.register_state_enter_callback(
            SystemState.ISLAND, self._on_island_enter
        )
        self.state_machine.register_state_enter_callback(
            SystemState.SIDESHEET, self._on_sidesheet_enter
        )
    
    def _on_island_enter(self, state: SystemState):
        """çµåŠ¨å²›çŠ¶æ€è¿›å…¥å›è°ƒ"""
        event_bus.publish_sync(
            EventType.UI_STATE_CHANGED,
            "state_machine",
            {"state": state.value, "action": "play_animation", "animation_type": "island_appear"}
        )
    
    def on_hardware_button_pressed(self, button_id: str):
        """ç¡¬ä»¶æŒ‰é”®æŒ‰ä¸‹å¤„ç†"""
        if button_id == "power" or button_id == "assistant":
            self.state_machine.wakeup(
                trigger_type=TriggerType.HARDWARE_BUTTON,
                trigger_source=f"button_{button_id}"
            )
    
    def on_gesture_detected(self, gesture_type: str):
        """æ‰‹åŠ¿æ£€æµ‹å¤„ç†"""
        if gesture_type == "swipe_up":
            self.state_machine.expand_to_sidesheet()
        elif gesture_type == "swipe_down":
            self.state_machine.collapse_to_island()
```

**å…³é”®ä»£ç è¡Œæ•°**: çº¦150è¡Œ

---

### 4. UIçŠ¶æ€ â†’ ç¡¬ä»¶è§¦å‘ï¼ˆç•Œé¢çŠ¶æ€åˆ°ç³»ç»Ÿè®°å½•ï¼‰

#### åŠ¨ç”»çŠ¶æ€ç®¡ç†
**æ–‡ä»¶**: `system_integration/state_machine_ui_integration.py`

```python
def start_animation(self, animation_id: str, animation_type: str):
    """å¼€å§‹åŠ¨ç”»ï¼ˆUIçŠ¶æ€ â†’ ç¡¬ä»¶è§¦å‘ é›†æˆç‚¹ï¼‰"""
    animation = AnimationState(
        animation_id=animation_id,
        animation_type=animation_type,
        state="started",
        started_at=datetime.now()
    )
    self._animations[animation_id] = animation
    
    event_bus.publish_sync(
        EventType.ANIMATION_STARTED,
        "ui",
        {"animation_id": animation_id, "animation_type": animation_type}
    )

def complete_animation(self, animation_id: str, success: bool = True):
    """å®ŒæˆåŠ¨ç”»ï¼ˆUIçŠ¶æ€ â†’ ç¡¬ä»¶è§¦å‘ é›†æˆç‚¹ï¼‰"""
    if animation_id in self._animations:
        animation = self._animations[animation_id]
        animation.state = "completed" if success else "error"
        animation.completed_at = datetime.now()
        
        event_bus.publish_sync(
            EventType.ANIMATION_COMPLETED,
            "ui",
            {
                "animation_id": animation_id,
                "animation_type": animation.animation_type,
                "success": success
            }
        )
        
        # è®°å½•è½¬æ¢å†å²
        self._record_animation_transition(animation)
```

**å…³é”®ä»£ç è¡Œæ•°**: çº¦80è¡Œ

---

## ä»£ç ç»Ÿè®¡

| æ¨¡å— | æ–‡ä»¶ | ä»£ç è¡Œæ•° | åŠŸèƒ½ |
|------|------|----------|------|
| äº‹ä»¶æ€»çº¿ | `integration/event_bus.py` | 350 | äº‹ä»¶å‘å¸ƒè®¢é˜…ç³»ç»Ÿ |
| L4ä¸»å¾ªç¯å¢å¼ºç‰ˆ | `core/galaxy_main_loop_l4_enhanced.py` | 450 | å¸¦UIå›è°ƒçš„L4ä¸»å¾ªç¯ |
| Windowså®¢æˆ·ç«¯ | `windows_client/windows_client_integrated.py` | 550 | PyQt6 UIé›†æˆ |
| Androidå®¢æˆ·ç«¯ | `android_client/MainActivityIntegrated.kt` | 600 | Kotlin UIé›†æˆ |
| çŠ¶æ€æœºé›†æˆ | `system_integration/state_machine_ui_integration.py` | 500 | çŠ¶æ€æœºå’Œç¡¬ä»¶è§¦å‘ |
| WebSocketæœåŠ¡å™¨ | `integration/websocket_server.py` | 550 | åç«¯é€šä¿¡æœåŠ¡ |
| é›†æˆæµ‹è¯• | `tests/test_integration.py` | 450 | å®Œæ•´æµ‹è¯•å¥—ä»¶ |
| **æ€»è®¡** | **7ä¸ªæ–‡ä»¶** | **~3450è¡Œ** | **å®Œæ•´é›†æˆæ–¹æ¡ˆ** |

---

## æ•°æ®æµå›¾

### UI â†’ L4 æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·è¾“å…¥    â”‚â”€â”€â”€â–¶â”‚  æ„å›¾è§£æ    â”‚â”€â”€â”€â–¶â”‚ åˆ›å»ºGoalå¯¹è±¡ â”‚â”€â”€â”€â–¶â”‚ æ·»åŠ åˆ°é˜Ÿåˆ—   â”‚
â”‚  (UIç»„ä»¶)   â”‚    â”‚ (_parse_)   â”‚    â”‚ (PendingGoal)â”‚    â”‚(async.Queue)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  L4ä¸»å¾ªç¯    â”‚â—€â”€â”€â”€â”‚  è·å–ç›®æ ‡    â”‚â—€â”€â”€â”€â”‚  å‘å¸ƒäº‹ä»¶    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ (run_cycle) â”‚    â”‚(_perceive_) â”‚    â”‚(GOAL_SUBMITTED)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### L4 â†’ UI æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç›®æ ‡åˆ†è§£å¼€å§‹ â”‚â”€â”€â”€â–¶â”‚ å‘å¸ƒäº‹ä»¶     â”‚â”€â”€â”€â–¶â”‚ äº‹ä»¶æ€»çº¿     â”‚â”€â”€â”€â–¶â”‚ å¹¿æ’­ç»™å®¢æˆ·ç«¯ â”‚
â”‚(_callback_) â”‚    â”‚(DECOMPOSING)â”‚    â”‚ (EventBus)  â”‚    â”‚(WebSocket)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  UIæ›´æ–°æ˜¾ç¤º  â”‚â—€â”€â”€â”€â”‚ å¤„ç†æ¶ˆæ¯     â”‚â—€â”€â”€â”€â”‚ æ¥æ”¶äº‹ä»¶     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚(æ›´æ–°è¿›åº¦æ¡)  â”‚    â”‚(handleMsg)  â”‚    â”‚(onMessage)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç¡¬ä»¶è§¦å‘ â†’ UI æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¡¬ä»¶æŒ‰é”®æŒ‰ä¸‹ â”‚â”€â”€â”€â–¶â”‚ è§¦å‘ç®¡ç†å™¨   â”‚â”€â”€â”€â–¶â”‚ çŠ¶æ€æœºè½¬æ¢   â”‚â”€â”€â”€â–¶â”‚ å‘å¸ƒäº‹ä»¶     â”‚
â”‚(on_hardware)â”‚    â”‚(TriggerMgr) â”‚    â”‚ (wakeup)    â”‚    â”‚(STATE_TRANS)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ æ’­æ”¾åŠ¨ç”»     â”‚â—€â”€â”€â”€â”‚ æ‰§è¡Œå›è°ƒ     â”‚â—€â”€â”€â”€â”‚ æ¥æ”¶äº‹ä»¶     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚(çµåŠ¨å²›å‡ºç°)  â”‚    â”‚(_on_island_)â”‚    â”‚(subscribe)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### UIçŠ¶æ€ â†’ ç¡¬ä»¶è§¦å‘ æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åŠ¨ç”»å¼€å§‹     â”‚â”€â”€â”€â–¶â”‚ çŠ¶æ€æœºè®°å½•   â”‚â”€â”€â”€â–¶â”‚ å‘å¸ƒäº‹ä»¶     â”‚â”€â”€â”€â–¶â”‚ æ›´æ–°ç»Ÿè®¡     â”‚
â”‚(UIç»„ä»¶)     â”‚    â”‚(start_anim) â”‚    â”‚(ANIM_START) â”‚    â”‚(statistics) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åŠ¨ç”»å®Œæˆ     â”‚â”€â”€â”€â–¶â”‚ çŠ¶æ€æœºè®°å½•   â”‚â”€â”€â”€â–¶â”‚ å‘å¸ƒäº‹ä»¶     â”‚â”€â”€â”€â–¶â”‚ è§¦å‘å›è°ƒ     â”‚
â”‚(UIç»„ä»¶)     â”‚    â”‚(complete_)  â”‚    â”‚(ANIM_COMP)  â”‚    â”‚(callback)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æµ‹è¯•æ–¹æ³•

### 1. å•å…ƒæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰é›†æˆæµ‹è¯•
cd /mnt/okcomputer/output/ufo_galaxy_integration
python -m pytest tests/test_integration.py -v
```

### 2. ç«¯åˆ°ç«¯æµ‹è¯•

```bash
# 1. å¯åŠ¨WebSocketæœåŠ¡å™¨
python integration/websocket_server.py

# 2. å¯åŠ¨Windowså®¢æˆ·ç«¯
python windows_client/windows_client_integrated.py

# 3. åœ¨Androidè®¾å¤‡ä¸Šå®‰è£…å¹¶å¯åŠ¨åº”ç”¨
```

### 3. æ‰‹åŠ¨æµ‹è¯•åœºæ™¯

| æµ‹è¯•åœºæ™¯ | æ“ä½œ | é¢„æœŸç»“æœ |
|----------|------|----------|
| UI â†’ L4 | åœ¨è¾“å…¥æ¡†è¾“å…¥"æœç´¢æ–°é—»"å¹¶æäº¤ | ç›®æ ‡è¢«æ¥æ”¶ï¼Œä»»åŠ¡åˆ—è¡¨æ›´æ–° |
| L4 â†’ UI | ç­‰å¾…ç›®æ ‡å¤„ç†å®Œæˆ | è¿›åº¦æ¡æ›´æ–°ï¼Œæ˜¾ç¤ºå­ä»»åŠ¡åˆ—è¡¨ |
| ç¡¬ä»¶ â†’ UI | æŒ‰ä¸‹ç¡¬ä»¶æŒ‰é”® | ç³»ç»Ÿå”¤é†’ï¼Œæ’­æ”¾çµåŠ¨å²›åŠ¨ç”» |
| UI â†’ ç¡¬ä»¶ | ç­‰å¾…åŠ¨ç”»å®Œæˆ | çŠ¶æ€æœºè®°å½•è½¬æ¢å†å² |

---

## éƒ¨ç½²è¯´æ˜

### 1. å®‰è£…ä¾èµ–

```bash
# Pythonä¾èµ–
pip install PyQt6 websockets aiohttp asyncio

# Androidä¾èµ–
# åœ¨build.gradleä¸­æ·»åŠ :
# implementation "org.java-websocket:Java-WebSocket:1.5.3"
# implementation 'com.squareup.okhttp3:okhttp:4.10.0'
```

### 2. é…ç½®æœåŠ¡å™¨åœ°å€

```kotlin
// Androidå®¢æˆ·ç«¯é…ç½®
private const val WS_URL = "ws://your-server:8080/ws"
private const val HTTP_URL = "http://your-server:8080/api"
```

### 3. å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨WebSocketå’ŒHTTPæœåŠ¡å™¨
python integration/websocket_server.py
```

---

## æ€»ç»“

é€šè¿‡æœ¬æ¬¡é›†æˆå®ç°ï¼ŒUFO Galaxyç³»ç»Ÿçš„UIä¸L4ä¸»å¾ªç¯å·²ç»å®Œå…¨æ‰“é€šï¼š

1. **UI â†’ L4**: ç”¨æˆ·è¾“å…¥é€šè¿‡Windows/Androidå®¢æˆ·ç«¯æäº¤åˆ°L4ä¸»å¾ªç¯
2. **L4 â†’ UI**: L4æ‰§è¡Œè¿›åº¦é€šè¿‡äº‹ä»¶æ€»çº¿å®æ—¶æ¨é€åˆ°UI
3. **ç¡¬ä»¶ â†’ UI**: ç¡¬ä»¶è§¦å‘é€šè¿‡çŠ¶æ€æœºç®¡ç†å™¨é€šçŸ¥UIæ’­æ”¾åŠ¨ç”»
4. **UI â†’ ç¡¬ä»¶**: UIåŠ¨ç”»å®Œæˆæ—¶é€šçŸ¥çŠ¶æ€æœºè®°å½•è½¬æ¢å†å²

æ•´ä¸ªç³»ç»Ÿç°åœ¨å¯ä»¥å®ç°å®Œæ•´çš„ç”¨æˆ·è¾“å…¥â†’ç³»ç»Ÿæ‰§è¡Œâ†’ç•Œé¢æ›´æ–°çš„é—­ç¯ã€‚

---

## Round 2 (R-4) æ›´æ–°ï¼šèƒ½åŠ›æ³¨å†Œä¸è¿æ¥ç®¡ç†

### æ–°å¢ç³»ç»Ÿç‰¹æ€§

åœ¨ Round 2 (R-4) ä¸­ï¼ŒUFO Galaxy ç³»ç»Ÿè¿›è¡Œäº†é‡å¤§æ¶æ„å‡çº§ï¼Œé›†æˆäº†ï¼š

#### 1. èƒ½åŠ›æ³¨å†Œä¸å‘ç°ç³»ç»Ÿ (OpenClaw é£æ ¼)

**æ ¸å¿ƒç»„ä»¶**: `core/capability_manager.py`

å®ç°äº†ç»Ÿä¸€çš„èƒ½åŠ›æ³¨å†Œã€å‘ç°å’Œè°ƒç”¨æœºåˆ¶ï¼š

```python
# èƒ½åŠ›æ³¨å†Œ
await capability_manager.register_capability(
    name="http_get",
    description="HTTP GET è¯·æ±‚",
    node_id="08",
    node_name="Fetch",
    category="http"
)

# èƒ½åŠ›å‘ç°
capabilities = capability_manager.discover_capabilities(category="http")

# çŠ¶æ€æ›´æ–°
await capability_manager.update_capability_status(
    "http_get", CapabilityStatus.ONLINE
)
```

**ç‰¹æ€§**:
- âœ… èŠ‚ç‚¹å¯åŠ¨æ—¶è‡ªåŠ¨æ³¨å†Œèƒ½åŠ›
- âœ… èƒ½åŠ›æŒ‰åˆ†ç±»ã€çŠ¶æ€ã€èŠ‚ç‚¹ç­›é€‰
- âœ… å®æ—¶çŠ¶æ€è·Ÿè¸ª (online/offline/error)
- âœ… æŒä¹…åŒ–åˆ° `config/capabilities.json`
- âœ… ä¸èŠ‚ç‚¹æ³¨å†Œè¡¨ (`node_registry.py`) æ·±åº¦é›†æˆ

#### 2. ç¨³å®šè¿æ¥ç®¡ç† (å‘æ—¥è‘µé£æ ¼)

**æ ¸å¿ƒç»„ä»¶**: `core/connection_manager.py`

å®ç°äº†å¥å£®çš„è¿æ¥ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼š

```python
# æ³¨å†Œè¿æ¥
await connection_manager.register_connection(
    connection_id="node_08",
    url="http://localhost:8008",
    config=ConnectionConfig(heartbeat_interval=30.0)
)

# å»ºç«‹è¿æ¥ï¼ˆè‡ªåŠ¨å¯åŠ¨å¿ƒè·³ï¼‰
await connection_manager.connect("node_08")

# è‡ªåŠ¨é‡è¿ï¼ˆæŒ‡æ•°é€€é¿ï¼‰
await connection_manager.reconnect("node_08")
```

**ç‰¹æ€§**:
- âœ… å¿ƒè·³/ä¿æ´»æœºåˆ¶ï¼ˆå¯é…ç½®é—´éš”ï¼‰
- âœ… æ–­çº¿è‡ªåŠ¨æ£€æµ‹
- âœ… æŒ‡æ•°é€€é¿é‡è¿ç­–ç•¥
- âœ… è¿æ¥å¥åº·çŠ¶æ€ç›‘æ§
- âœ… å›è°ƒæœºåˆ¶ï¼ˆè¿æ¥/æ–­å¼€äº‹ä»¶ï¼‰
- âœ… æŒä¹…åŒ–åˆ° `config/connection_state.json`

#### 3. ç»Ÿä¸€è¿è¡Œæ—¶æµç¨‹

ç³»ç»Ÿå¯åŠ¨æµç¨‹å·²å®Œå…¨é›†æˆèƒ½åŠ›å’Œè¿æ¥ç®¡ç†ï¼š

```
é…ç½®åŠ è½½ â†’ èƒ½åŠ›æ³¨å†Œ â†’ èŠ‚ç‚¹å¯åŠ¨ â†’ è¿æ¥åˆå§‹åŒ– â†’ å¥åº·ç›‘æ§
    â†“           â†“           â†“            â†“            â†“
  ç¯å¢ƒå˜é‡   èƒ½åŠ›ç´¢å¼•   è¿›ç¨‹ç®¡ç†    å¿ƒè·³/é‡è¿    çŠ¶æ€æŠ¥å‘Š
```

**é›†æˆç‚¹**:

1. **`unified_launcher.py`**: 
   - åˆå§‹åŒ–èƒ½åŠ›å’Œè¿æ¥ç®¡ç†å™¨
   - åœ¨é…ç½®æ£€æŸ¥é˜¶æ®µæŠ¥å‘Šèƒ½åŠ›å’Œè¿æ¥çŠ¶æ€

2. **`system_manager.py`**:
   - èŠ‚ç‚¹å¯åŠ¨æ—¶è‡ªåŠ¨æ³¨å†Œè¿æ¥
   - ä» `node_dependencies.json` è¯»å–å¹¶æ³¨å†Œèƒ½åŠ›

3. **`health_monitor.py`**:
   - å¥åº·æ£€æŸ¥æ—¶åŒæ­¥æ›´æ–°èƒ½åŠ›çŠ¶æ€
   - çŠ¶æ€æŠ¥å‘ŠåŒ…å«èƒ½åŠ›å’Œè¿æ¥ç»Ÿè®¡

4. **`node_registry.py`**:
   - èŠ‚ç‚¹æ³¨å†Œæ—¶è‡ªåŠ¨æ³¨å†Œèƒ½åŠ›
   - å¥åº·æ£€æŸ¥æ—¶æ›´æ–°èƒ½åŠ›çŠ¶æ€

#### 4. å¯è§‚æµ‹æ€§å’ŒéªŒè¯

**éªŒè¯å·¥å…·**:

```bash
# éªŒè¯èƒ½åŠ›æ³¨å†Œç³»ç»Ÿ
python scripts/verify_capability_registry.py
# è¾“å‡º: èƒ½åŠ›ç®¡ç†å™¨ã€è¿æ¥ç®¡ç†å™¨ã€ç³»ç»Ÿé›†æˆéªŒè¯

# è¿è¡Œé›†æˆæµ‹è¯•
python tests/test_capability_integration.py
# è¾“å‡º: 9ä¸ªæµ‹è¯•ç”¨ä¾‹å…¨éƒ¨é€šè¿‡
```

**çŠ¶æ€æŸ¥è¯¢**:

```python
# èƒ½åŠ›ç»Ÿè®¡
cap_stats = capability_manager.get_stats()
# {
#   "total_capabilities": 50,
#   "online": 45,
#   "offline": 5,
#   "categories": {"http": 10, "database": 15, ...}
# }

# è¿æ¥ç»Ÿè®¡
conn_stats = connection_manager.get_stats()
# {
#   "total_connections": 102,
#   "connected": 98,
#   "disconnected": 2,
#   "error": 2
# }

# å¥åº·æŠ¥å‘Šï¼ˆåŒ…å«èƒ½åŠ›å’Œè¿æ¥ï¼‰
health_report = health_monitor.get_summary()
# {
#   "total_nodes": 102,
#   "healthy_nodes": 98,
#   "capabilities": {...},
#   "connections": {...}
# }
```

#### 5. é…ç½®æ–‡ä»¶

ç³»ç»Ÿè¿è¡Œåç”Ÿæˆä¸¤ä¸ªå…³é”®é…ç½®æ–‡ä»¶ï¼š

**`config/capabilities.json`**:
```json
{
  "version": "1.0.0",
  "timestamp": "2026-02-11T08:00:00",
  "capabilities": [
    {
      "name": "http_get",
      "description": "HTTP GET è¯·æ±‚",
      "node_id": "08",
      "node_name": "Fetch",
      "category": "http",
      "status": "online",
      "last_updated": "2026-02-11T08:00:30"
    }
  ]
}
```

**`config/connection_state.json`**:
```json
{
  "timestamp": "2026-02-11T08:00:00",
  "connections": [
    {
      "connection_id": "node_08",
      "url": "http://localhost:8008",
      "state": "connected",
      "connected_at": "2026-02-11T08:00:05",
      "last_heartbeat": "2026-02-11T08:00:30",
      "total_reconnects": 0
    }
  ]
}
```

### æ¶æ„å½±å“

R-4 æ›´æ–°åçš„ç³»ç»Ÿæ¶æ„ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç»Ÿä¸€å¯åŠ¨å™¨ (unified_launcher)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ é…ç½®ç®¡ç†       â”‚  â”‚ èƒ½åŠ›ç®¡ç†å™¨     â”‚  â”‚ è¿æ¥ç®¡ç†å™¨     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç³»ç»Ÿç®¡ç†å™¨ (system_manager)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ èŠ‚ç‚¹å¯åŠ¨ â†’ èƒ½åŠ›æ³¨å†Œ â†’ è¿æ¥åˆå§‹åŒ– â†’ å¿ƒè·³å¯åŠ¨          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    èŠ‚ç‚¹æ³¨å†Œè¡¨ (node_registry)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ èŠ‚ç‚¹æ³¨å†Œ       â”‚  â”‚ èƒ½åŠ›ç´¢å¼•       â”‚  â”‚ å¥åº·æ£€æŸ¥       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å¥åº·ç›‘æ§ (health_monitor)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ èŠ‚ç‚¹å¥åº· + èƒ½åŠ›çŠ¶æ€ + è¿æ¥çŠ¶æ€ â†’ ç»Ÿä¸€æŠ¥å‘Š            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¼˜åŠ¿æ€»ç»“

é€šè¿‡ R-4 æ›´æ–°ï¼ŒUFO Galaxy ç³»ç»Ÿè·å¾—äº†ï¼š

1. **å®Œæ•´çš„èƒ½åŠ›æŠ½è±¡å±‚**: ä¸å†ç›´æ¥ä¾èµ–èŠ‚ç‚¹IDï¼Œé€šè¿‡èƒ½åŠ›åç§°è°ƒç”¨
2. **å¥å£®çš„é€šä¿¡å±‚**: è‡ªåŠ¨é‡è¿å’Œå¿ƒè·³ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§
3. **ç»Ÿä¸€çš„ç›‘æ§è§†å›¾**: èŠ‚ç‚¹ã€èƒ½åŠ›ã€è¿æ¥çŠ¶æ€ä¸€ç›®äº†ç„¶
4. **å¯æ‰©å±•æ€§**: æ–°èŠ‚ç‚¹åªéœ€æ³¨å†Œèƒ½åŠ›ï¼Œå³å¯è¢«ç³»ç»Ÿå‘ç°å’Œä½¿ç”¨
5. **å¯è§‚æµ‹æ€§**: å®Œæ•´çš„çŠ¶æ€è·Ÿè¸ªå’Œæ—¥å¿—è®°å½•

---

**UFO Galaxy ç°åœ¨æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿç¾¤å‹æ¶æ„ï¼Œå…·å¤‡ L4 çº§è‡ªä¸»æ€§å’Œä¼ä¸šçº§å¯é æ€§ï¼** ğŸš€
