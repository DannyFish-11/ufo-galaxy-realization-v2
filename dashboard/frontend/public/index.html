<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UFOÂ³ Galaxy - AI æ™ºèƒ½ä½“</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&display=swap');
        
        * {
            font-family: 'JetBrains Mono', monospace;
        }
        
        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
        }
        
        .scroll-paper {
            background: linear-gradient(to right, #f5f0e6, #faf8f3, #f5f0e6);
            box-shadow: -5px 0 20px rgba(0,0,0,0.3), 5px 0 20px rgba(0,0,0,0.3);
        }
        
        .ink-border {
            background: linear-gradient(to bottom, #333, #000, #333);
        }
        
        .glow-text {
            text-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
        }
        
        .status-dot {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .chat-bubble-user {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        }
        
        .chat-bubble-ai {
            background: linear-gradient(135deg, #374151, #1f2937);
        }
        
        .typing-indicator span {
            animation: typing 1.4s infinite;
        }
        
        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }
    </style>
</head>
<body class="text-gray-100 min-h-screen">
    <div id="app" class="h-screen flex flex-col">
        <!-- é¡¶éƒ¨æ ‡é¢˜æ  -->
        <header class="bg-gray-900 border-b border-gray-800 px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="w-3 h-3 rounded-full status-dot" :class="systemStatus === 'healthy' ? 'bg-green-500' : 'bg-red-500'"></div>
                    <h1 class="text-xl font-bold glow-text">UFOÂ³ GALAXY</h1>
                    <span class="text-xs text-gray-500">L4 è‡ªä¸»æ€§æ™ºèƒ½ç³»ç»Ÿ v2.3.20</span>
                </div>
                <div class="flex items-center space-x-4 text-xs text-gray-400">
                    <span>èŠ‚ç‚¹: {{ nodeCount }}</span>
                    <span>è®¾å¤‡: {{ deviceCount }}</span>
                    <span>Agent: {{ agentCount }}</span>
                    <span>{{ currentTime }}</span>
                </div>
            </div>
        </header>
        
        <!-- ä¸»å†…å®¹åŒº - ä¹¦æ³•å·è½´å¼å¯¹è¯ç•Œé¢ -->
        <main class="flex-1 flex overflow-hidden">
            <!-- å·¦ä¾§å¢¨è¿¹è¾¹æ¡† -->
            <div class="w-2 ink-border"></div>
            
            <!-- å·è½´ä¸»ä½“ - å¯¹è¯åŒºåŸŸ -->
            <div class="flex-1 scroll-paper overflow-auto p-6" ref="chatContainer">
                <div class="max-w-4xl mx-auto space-y-4">
                    <!-- æ¶ˆæ¯åˆ—è¡¨ -->
                    <div v-for="msg in messages" :key="msg.id" 
                         class="flex" :class="msg.role === 'user' ? 'justify-end' : 'justify-start'">
                        <div class="max-w-3xl rounded-lg p-4"
                             :class="msg.role === 'user' ? 'chat-bubble-user text-white' : 'chat-bubble-ai text-gray-100'">
                            <div class="whitespace-pre-wrap text-sm leading-relaxed">{{ msg.content }}</div>
                            <div class="text-xs mt-2 opacity-50">{{ formatTime(msg.timestamp) }}</div>
                        </div>
                    </div>
                    
                    <!-- åŠ è½½æŒ‡ç¤ºå™¨ -->
                    <div v-if="isLoading" class="flex justify-start">
                        <div class="chat-bubble-ai rounded-lg p-4">
                            <div class="typing-indicator flex space-x-1">
                                <span class="w-2 h-2 bg-blue-400 rounded-full"></span>
                                <span class="w-2 h-2 bg-blue-400 rounded-full"></span>
                                <span class="w-2 h-2 bg-blue-400 rounded-full"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- å³ä¾§å¢¨è¿¹è¾¹æ¡† -->
            <div class="w-2 ink-border"></div>
        </main>
        
        <!-- åº•éƒ¨è¾“å…¥åŒº -->
        <footer class="bg-gray-900 border-t border-gray-800 p-4">
            <div class="max-w-4xl mx-auto flex space-x-4">
                <input v-model="inputText" @keyup.enter="sendMessage"
                       type="text" placeholder="è¾“å…¥å‘½ä»¤æˆ–é—®é¢˜... (ä¾‹å¦‚: æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€)"
                       class="flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:outline-none focus:border-blue-500 text-sm">
                <button @click="sendMessage" 
                        class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium text-sm">
                    å‘é€
                </button>
                <button @click="startVoiceInput"
                        class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-3 rounded-lg text-sm">
                    ğŸ¤
                </button>
            </div>
            <div class="max-w-4xl mx-auto mt-2 text-xs text-gray-500">
                ğŸ’¡ æç¤º: è¯´ "å¸®åŠ©" æŸ¥çœ‹å¯ç”¨å‘½ä»¤ | æ‰€æœ‰èƒ½åŠ›éƒ½é›†æˆåœ¨å¯¹è¯ä¸­
            </div>
        </footer>
    </div>
    
    <script>
        const { createApp, ref, onMounted, nextTick } = Vue;
        
        createApp({
            setup() {
                const systemStatus = ref('healthy');
                const inputText = ref('');
                const isLoading = ref(false);
                const currentTime = ref('');
                const nodeCount = ref(108);
                const deviceCount = ref(0);
                const agentCount = ref(0);
                const chatContainer = ref(null);
                
                const messages = ref([
                    {
                        id: '1',
                        role: 'assistant',
                        content: `ä½ å¥½ï¼æˆ‘æ˜¯ UFO Galaxy æ™ºèƒ½ä½“ã€‚

æˆ‘æ˜¯ L4 çº§è‡ªä¸»æ€§æ™ºèƒ½ç³»ç»Ÿï¼Œå…·å¤‡ä»¥ä¸‹èƒ½åŠ›ï¼š
â€¢ AI é©±åŠ¨ - è‡ªç„¶è¯­è¨€ç†è§£ä¸ç”Ÿæˆ
â€¢ è·¨è®¾å¤‡æ§åˆ¶ - æ§åˆ¶æ‰‹æœºã€å¹³æ¿ã€ç”µè„‘
â€¢ è‡ªä¸»å­¦ä¹  - æŒç»­å­¦ä¹ å’ŒçŸ¥è¯†ç§¯ç´¯
â€¢ è‡ªä¸»æ€è€ƒ - å…ƒè®¤çŸ¥å’Œç›®æ ‡åˆ†è§£
â€¢ è‡ªä¸»ç¼–ç¨‹ - ä»£ç ç”Ÿæˆå’Œä¼˜åŒ–
â€¢ çŸ¥è¯†åº“ - çŸ¥è¯†å­˜å‚¨å’Œæ£€ç´¢

ä½ åªéœ€è¦ç”¨è‡ªç„¶è¯­è¨€ä¸æˆ‘å¯¹è¯ï¼Œæˆ‘ä¼šè‡ªåŠ¨ç†è§£å¹¶æ‰§è¡Œã€‚

è¯´ "å¸®åŠ©" æŸ¥çœ‹å¯ç”¨å‘½ä»¤ã€‚`,
                        timestamp: Date.now()
                    }
                ]);
                
                const formatTime = (timestamp) => {
                    return new Date(timestamp).toLocaleTimeString();
                };
                
                const scrollToBottom = async () => {
                    await nextTick();
                    if (chatContainer.value) {
                        chatContainer.value.scrollTop = chatContainer.value.scrollHeight;
                    }
                };
                
                const sendMessage = async () => {
                    if (!inputText.value.trim()) return;
                    
                    const userMessage = {
                        id: Date.now().toString(),
                        role: 'user',
                        content: inputText.value,
                        timestamp: Date.now()
                    };
                    messages.value.push(userMessage);
                    
                    const query = inputText.value;
                    inputText.value = '';
                    isLoading.value = true;
                    scrollToBottom();
                    
                    try {
                        const response = await axios.post('/api/v1/chat', {
                            message: query,
                            device_id: 'web_dashboard'
                        });
                        
                        const aiMessage = {
                            id: (Date.now() + 1).toString(),
                            role: 'assistant',
                            content: response.data.response || 'å·²æ”¶åˆ°æŒ‡ä»¤ï¼Œæ­£åœ¨å¤„ç†...',
                            timestamp: Date.now()
                        };
                        messages.value.push(aiMessage);
                        
                        // æ›´æ–°çŠ¶æ€
                        if (response.data.data) {
                            if (response.data.data.nodes) nodeCount.value = response.data.data.total || 108;
                            if (response.data.data.devices) deviceCount.value = response.data.data.total || 0;
                            if (response.data.data.agents) agentCount.value = response.data.data.total || 0;
                        }
                    } catch (error) {
                        console.error('API Error:', error);
                        const errorMessage = {
                            id: (Date.now() + 1).toString(),
                            role: 'assistant',
                            content: 'æŠ±æ­‰ï¼Œè¿æ¥æœåŠ¡æ—¶å‡ºé”™ã€‚\n\nè¯·ç¡®ä¿åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œ:\npython main.py',
                            timestamp: Date.now()
                        };
                        messages.value.push(errorMessage);
                    }
                    
                    isLoading.value = false;
                    scrollToBottom();
                };
                
                const startVoiceInput = () => {
                    alert('è¯­éŸ³è¾“å…¥åŠŸèƒ½å¼€å‘ä¸­...\n\nç›®å‰è¯·ä½¿ç”¨æ–‡å­—è¾“å…¥ã€‚');
                };
                
                const updateTime = () => {
                    currentTime.value = new Date().toLocaleTimeString();
                    setTimeout(updateTime, 1000);
                };
                
                onMounted(() => {
                    updateTime();
                    scrollToBottom();
                });
                
                return {
                    systemStatus,
                    inputText,
                    isLoading,
                    currentTime,
                    nodeCount,
                    deviceCount,
                    agentCount,
                    messages,
                    chatContainer,
                    formatTime,
                    sendMessage,
                    startVoiceInput
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
